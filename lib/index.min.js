!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,e.ELM=t()}}(function(){return function(){function t(e,i,n){function s(h,r){if(!i[h]){if(!e[h]){var a="function"==typeof require&&require;if(!r&&a)return a(h,!0);if(o)return o(h,!0);var c=new Error("Cannot find module '"+h+"'");throw c.code="MODULE_NOT_FOUND",c}var l=i[h]={exports:{}};e[h][0].call(l.exports,function(t){return s(e[h][1][t]||t)},l,l.exports,t,e,i,n)}return i[h].exports}for(var o="function"==typeof require&&require,h=0;h<n.length;h++)s(n[h]);return s}return t}()({1:[function(t,e,i){const n=t("../common/common"),s={value:.18,radius:120,lineWidth:16,startAngle:180,sweepAngle:360,backdropPadding:4,showHandle:!0,handleRadius:2,handleColor:"#333",rangeColor:"#fc1",backdropColor:"#330",indicatorColor:"#333",rounded:!0},o=t=>t*(Math.PI/180),h=function(t,e){return new h.init(t,e)};h.init=function(t,e){if(void 0===t)throw"(Circle) id is required";e=e||window.document.body,this.id=t,this.ctx=null,this.element=null,this.subscribers=[],this.config=Object.assign({},s),this.value=this.config.value,this.element=window.document.createElement("canvas"),this.element.id=this.id,this.ctx=this.element.getContext("2d"),e.appendChild(this.element),this.configure(),this.render(),this.activate()},h.prototype={render:function(){this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height);let t=this.ctx.canvas.width/2,e=o(this.config.sweepAngle)*this.value+o(this.config.startAngle);return this.ctx.lineWidth=this.config.lineWidth,this.ctx.strokeStyle=this.config.backdropColor,this.ctx.beginPath(),this.ctx.arc(t,t,t-this.config.lineWidth/2,o(this.config.startAngle)-.04,o(this.config.startAngle+this.config.sweepAngle)+.04),this.ctx.stroke(),this.ctx.lineWidth=this.config.lineWidth-2*this.config.backdropPadding,this.ctx.strokeStyle=this.config.rangeColor,this.ctx.beginPath(),this.ctx.arc(t,t,t-this.config.lineWidth/2,o(this.config.startAngle),e),this.ctx.stroke(),this.config.showHandle&&(this.ctx.beginPath(),this.ctx.lineWidth=2*this.config.handleRadius,this.ctx.arc(t,t,t-this.config.lineWidth/2,e-.01,e+.01),this.ctx.strokeStyle=this.config.indicatorColor,this.ctx.stroke()),this.emit(this.value),this},configure:function(t){return this.config=Object.assign(this.config,t),this.value=this.config.value,this.element.width=this.config.radius,this.element.height=this.config.radius,this.ctx.canvas.width=this.element.clientWidth,this.ctx.canvas.height=this.element.clientHeight,this.ctx.lineCap=this.config.rounded?"round":"butt",this.render(),this},mouseDragHandler:function(t){t.preventDefault();let e=t.clientY;window.onmouseup=(t=>{t.preventDefault(),window.onmouseup=null,window.onmousemove=null}),window.onmousemove=(t=>{t.preventDefault(),t.clientY>e?this.value-=.03:this.value+=.03,e=t.clientY,this.value=this.value>=1?1:this.value,this.value=this.value<=0?0:this.value,this.render()})},setValue:function(t){return this.value=t,this.render(),this},subscribe:n.events.subscribe,unsubscribe:n.events.unsubscribe,emit:n.events.emit,deactivate:function(){return this.element.onmousedown=null,this},activate:function(){return this.element.onmousedown=this.mouseDragHandler.bind(this),this}},h.init.prototype=h.prototype,e.exports=h},{"../common/common":2}],2:[function(t,e,i){"use strict";function n(t){if(!(!this.subscribers.indexOf(t)<0))return t.update(this.value),this.subscribers.push(t),this}function s(t){let e=this.subscribers.indexOf(t);if(!(e<0))return this.subscribers.splice(e,1),this}function o(t){return this.subscribers.map(e=>e.update(t)),t}const h=function(t){if(t.touches.length){const e=[];for(let i of t.touches)i.target.id===this.element.id&&e.push(i);return e.length?e[0]:null}};e.exports={events:{subscribe:n,unsubscribe:s,emit:o},touch:{findTouch:h}}},{}],3:[function(t,e,i){const n=t("./synth/synth"),s=t("./keyboard/keyboard"),o=t("./circle/circle"),h=t("./label/label"),r=t("./scope/scope"),a=t("./slider/slider"),c=t("./waveform/waveform"),l=t("./xypad/xypad"),u={Synth:n,KeyBoard:s,GUI:{Circle:o,Label:h,Scope:r,Slider:a,WaveForm:c,XYPad:l}};e.exports=u},{"./circle/circle":1,"./keyboard/keyboard":4,"./label/label":5,"./scope/scope":6,"./slider/slider":7,"./synth/synth":8,"./waveform/waveform":10,"./xypad/xypad":11}],4:[function(t,e,i){"use strict";const n=t("../utils/utils"),s={a:{note:"C",freq:16.35},w:{note:"C#",freq:17.32},s:{note:"D",freq:18.35},e:{note:"D#",freq:19.45},d:{note:"E",freq:20.6},f:{note:"F",freq:21.83},t:{note:"F#",freq:23.12},g:{note:"G",freq:24.5},y:{note:"G#",freq:25.96},h:{note:"A",freq:27.5},u:{note:"A#",freq:29.14},j:{note:"B",freq:30.87},k:{note:"C",freq:32.7},o:{note:"C#",freq:34.65},l:{note:"D",freq:36.71},p:{note:"D#",freq:38.89}},o={z:"octave-down",x:"octave-up",c:"velocity-down",v:"velocity-up",b:"hold-mode"},h=(t,e)=>new h.init(t,e);h.init=function(t=1,e=100){this.octave=t,this.velocity=e,this.holdMode=!1,this.heldKeys={},this.subscribers=[],this.activate()},h.prototype={subscribe:function(t){if(!(!this.subscribers.indexOf(t)<0))return t.update(this.value),this.subscribers.push(t),this},unsubscribe:function(t){let e=this.subscribers.indexOf(t);if(!(e<0))return this.subscribers.splice(e,1),this},emit:function(t){return this.subscribers.map(e=>e.update(t)),t},noteToFreq:function(t){return t.freq*Math.pow(2,this.octave)},activeVoices:0,keyHandler:function(t){const e=s[t.key],i=o[t.key];if("keydown"===t.type){const s=!this.heldKeys.hasOwnProperty(t.key)||this.holdMode;if(e&&s){const i=this.activeVoices++;this.heldKeys[t.key]=i;const n=Object.assign({},e,{voice:i,freq:this.noteToFreq(e),state:"on"});this.emit(n)}if(i){let t=null;switch(i){case"octave-up":this.octave=n.limitTo(this.octave+1,-8,8),t={command:i,state:this.octave};break;case"octave-down":this.octave=n.limitTo(this.octave-1,-8,8),t={command:i,state:this.octave};break;case"velocity-up":this.velocity=n.limitTo(this.velocity+5,0,127),t={command:i,state:this.velocity};break;case"velocity-down":this.velocity=n.limitTo(this.velocity-5,0,127),t={command:i,state:this.velocity};break;case"hold-mode":this.holdMode=!this.holdMode,t={command:i,state:this.holdMode}}t&&this.emit(t)}}if("keyup"===t.type){const i=this.heldKeys[t.key];if(void 0!==i&&!this.holdMode){delete this.heldKeys[t.key];const n=Object.assign({},e,{voice:i,freq:this.noteToFreq(e),state:"off"});this.emit(n)}Object.keys(this.heldKeys).length||(this.activeVoices=0)}},deactivate:function(){return window.removeEventListener("keydown",this.keyHandler.bind(this)),window.removeEventListener("keyup",this.keyHandler.bind(this)),this},activate:function(){return window.addEventListener("keydown",this.keyHandler.bind(this)),window.addEventListener("keyup",this.keyHandler.bind(this)),this}},h.init.prototype=h.prototype,e.exports=h},{"../utils/utils":9}],5:[function(t,e,i){(function(t){"use strict";const i={value:.5,color:"#ddd",fontSize:24,fontFamily:"Lucida Console"},n=function(t,e){return new n.init(t,e)};n.init=function(e,n){if(void 0===e)throw"(Label) id is required";n=n||t.document.body,this.id=e,this.element=null,this.displayValue=null,this.config=Object.assign({},i),this.value=this.config.value,this.element=t.document.createElement("span"),this.element.style.position="absolute",this.element.style.pointerEvents="none",this.element.id=this.id,n.appendChild(this.element),this.configure({}),this.render()},n.prototype={transformer:t=>t.toFixed(2),render:function(){return this.element.innerHTML=this.transformer(this.value),this},configure:function(t){return this.config=Object.assign(this.config,t),this.value=this.config.value,this.element.style.fontFamily=this.config.fontFamily,this.element.style.fontSize=this.config.fontSize,this.element.style.color=this.config.color,this.render(),this},update:function(t){return this.value=t,this.render(),this}},n.init.prototype=n.prototype,e.exports=n}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],6:[function(t,e,i){var n=function(t){"use strict";const e=(t,i)=>new e.init(t,i);e.init=function(e,i){if(void 0===e)throw"(Scope) id is required";i=i||t.document.body,this.element=t.document.createElement("canvas"),this.element.id=e,i.appendChild(this.element)},e.prototype={run:function(){let t=this;this.analyser.getByteFrequencyData(this.dataArray);var e={src:0,val:0};for(let t=0;t<this.dataArray.length;t++){const i=Math.pow(this.dataArray[t],2);i>e.src&&(e.val=this.dataArray[t],e.src=i)}console.log("...",this.element.id,e.val,this.analyser.context.sampleRate,this.analyser.context.sampleRate/e.val),setTimeout(function(){t.run()},2e3)},init:function(t){return this.analyser=t.createAnalyser(),this.analyser.connect(t.destination),this.analyser.fftSize=256,this.bufferLength=this.analyser.frequencyBinCount,this.dataArray=new Uint8Array(this.bufferLength),this.analyser.getByteTimeDomainData(this.dataArray),this},connect:function(t){t.connect(this.analyser),this.analyser.connect(t.context.destination)}},e.init.prototype=e.prototype,t.Scope=e};void 0===i?n(window):i.ScopeMock=function(t){n(t)}},{}],7:[function(t,e,i){(function(i){const n=t("../common/common"),s={value:.5,width:120,lineWidth:14,handleRadius:0,vertical:!1,showHandle:!1,rangeColor:"#0af",handleColor:"#fff",indicatorColor:"#fc1",backdropColor:"#424242",rounded:!0},o=function(t,e){return new o.init(t,e)};o.init=function(t,e){this.id=t,this.ctx=null,this.element=null,this.displayValue=null,this.config=Object.assign({},s),this.subscribers=[],this.value=this.config.value,this.element=i.document.createElement("canvas"),this.element.id=this.id,this.ctx=this.element.getContext("2d"),e.appendChild(this.element),this.configure(),this.render(),this.activate()},o.prototype={get handleDiameter(){return 2*this.config.handleRadius},get totalWidth(){return this.config.vertical?Math.max(this.handleDiameter,this.config.lineWidth):this.handleDiameter+this.config.width},get totalHeight(){return this.config.vertical?this.handleDiameter+this.config.width:Math.max(this.handleDiameter,this.config.lineWidth)},get sliderMinX(){return this.config.handleRadius},get sliderMaxX(){return this.totalWidth-this.config.handleRadius},get sliderMinY(){return this.config.handleRadius},get sliderMaxY(){return this.totalHeight-this.config.handleRadius},render_horizontal:function(){let t=this.value*this.config.width+this.config.handleRadius;this.ctx.lineWidth=this.config.lineWidth,this.ctx.strokeStyle=this.config.backdropColor,this.ctx.beginPath(),this.ctx.moveTo(this.sliderMinX,this.sliderMinY),this.ctx.lineTo(this.sliderMaxX,this.sliderMinY),this.ctx.stroke(),this.ctx.lineWidth=this.config.lineWidth,this.ctx.strokeStyle=this.config.rangeColor,this.ctx.beginPath(),this.ctx.moveTo(this.sliderMinX,this.sliderMinY),this.ctx.lineTo(t,this.sliderMinY),this.ctx.stroke(),this.config.showHandle&&(this.ctx.fillStyle=this.config.handleColor,this.ctx.beginPath(),this.ctx.arc(t,this.sliderMinY,this.config.handleRadius,0,2*Math.PI),this.ctx.fill())},render_vertical:function(){let t=this.value*this.totalHeight-this.config.handleRadius;this.ctx.lineWidth=2*this.config.lineWidth,this.ctx.strokeStyle=this.config.backdropColor,this.ctx.beginPath(),this.ctx.moveTo(this.sliderMinX,this.sliderMinY),this.ctx.lineTo(this.sliderMinX,this.sliderMaxY),this.ctx.stroke(),this.ctx.lineWidth=2*this.config.lineWidth,this.ctx.strokeStyle=this.config.rangeColor,this.ctx.beginPath(),this.ctx.moveTo(this.sliderMinX,this.sliderMaxY),this.ctx.lineTo(this.sliderMinX,t),this.ctx.stroke(),this.config.showHandle&&(this.ctx.fillStyle=this.config.handleColor,this.ctx.beginPath(),this.ctx.arc(this.sliderMinY,t,this.config.handleRadius,0,2*Math.PI),this.ctx.fill())},render:function(){return this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.config.vertical?this.render_vertical():this.render_horizontal(),this.onChange(this.value,this.displayValue,this),this.emit(this.value),this},configure:function(t){return this.config=Object.assign(this.config,t),this.value=this.config.value,this.element.width=this.totalWidth,this.element.height=this.totalHeight,this.ctx.canvas.width=this.element.clientWidth,this.ctx.canvas.height=this.element.clientHeight,this.ctx.lineCap=this.config.rounded?"round":"butt",this.render(),this},displayFunction:function(){return this.displayValue=Math.pow(10*this.value,2),this.displayValue},mouseDragHandler:function(t){t.preventDefault(),i.document.onmouseup=(t=>{t.preventDefault(),i.document.onmouseup=null,i.document.onmousemove=null}),i.document.onmousemove=(t=>{if(t.preventDefault(),this.config.vertical){let e=this.ctx.canvas.getBoundingClientRect().top;this.value=(t.clientY-e)/this.totalHeight}else{let e=this.ctx.canvas.getBoundingClientRect().left;this.value=(t.clientX-e)/this.config.width}this.value=this.value>=1?1:this.value,this.value=this.value<=0?0:this.value,this.render()})},setValue:function(t){return this.value=t,this.render(),this},onChange:(t,e,i)=>{},subscribe:n.events.subscribe,unsubscribe:n.events.unsubscribe,emit:n.events.emit,deactivate:function(){return this.element.onmousedown=null,this},activate:function(){return this.element.onmousedown=this.mouseDragHandler.bind(this),this}},o.init.prototype=o.prototype,e.exports.Slider=o}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../common/common":2}],8:[function(t,e,i){function n(t){if(t.buffer&&!(t.grains>500)){t.grains++;const e=t.context,i=parseInt(s.random(0,3),10),n=e.createGain(),o=e.createBufferSource();o.playbackRate.setValueAtTime(o.playbackRate.value*t.trans,e.currentTime),o.buffer=t.buffer,n.connect(t.master);let h;1===i?(h=e.createPanner(),h.panningModel="equalpower",h.distanceModel="linear",h.setPosition(s.random(t.pan*-1,t.pan),0,0),o.connect(h),h.connect(n)):o.connect(n);const r=1===t.grainSkew?t.grainSize-.001:t.grainSize*t.grainSkew,a=Math.max(0,t.offset*t.buffer.duration),c=Math.abs(Math.random()*t.spread-t.spread/2);o.start(e.currentTime,a+c,t.grainSize),n.gain.setValueAtTime(0,e.currentTime),n.gain.linearRampToValueAtTime(t.amp,e.currentTime+r),n.gain.linearRampToValueAtTime(0,e.currentTime+t.grainSize),o.stop(e.currentTime+t.grainSize),setTimeout(()=>{t.grains--,n.disconnect(),1===i&&h.disconnect()},1001*t.grainSize)}}const s=t("../utils/utils"),o=t=>new o.init(t);o.init=function(t){this.master=context.createGain(),this.master.connect(t.filter),this.master.gain.setValueAtTime(.8,0),this.context=t.context,this.buffer=t.buffer,this.grains=0},o.prototype={offset:0,trans:1,attack:.2,release:.75,amp:.8,grainSize:1,grainSkew:.5,density:50,spread:.3,pan:1,play:function(){const t=this;this.release=Math.max(.01,this.release),this.play=function(){n(t),t.timeout=setTimeout(t.play,100-t.density)},this.play(),this.master.gain.setValueAtTime(0,this.context.currentTime),this.master.gain.linearRampToValueAtTime(this.amp,this.context.currentTime+this.attack)},stop:function(){const t=this;this.master.gain.linearRampToValueAtTime(0,this.context.currentTime+this.release),setTimeout(()=>{clearTimeout(t.timeout)},1001*this.release)}},o.init.prototype=o.prototype;const h=t=>new h.init(t);h.init=function(t){this.voices={},this.buffer=null,this.context=t,this.filter=t.createBiquadFilter(),this.filter.type="lowpass",this.filter.frequency.value=2e4,this.master=t.createGain(),this.filter.connect(this.master),this.master.connect(t.destination),this.master.gain.setValueAtTime(this.amp,0),this.controls=o.prototype},h.prototype={amp:.8,update:function(t){t&&t.hasOwnProperty("freq")&&t.hasOwnProperty("state")&&("on"===t.state?(this.voices[t.voice]=o(this),this.voices[t.voice].play()):this.voices[t.voice].stop())}},h.init.prototype=h.prototype,e.exports=h},{"../utils/utils":9}],9:[function(t,e,i){const n=(t,e,i)=>Math.min(Math.max(t,e),i),s=(t,e)=>Math.random()*(e-t)+t,o=(t,e,i,n,s)=>{return(t-e)*(s-n)/(i-e)+n},h=t=>t*(Math.PI/180);e.exports={limitTo:n,random:s,map:o,toRadians:h}},{}],10:[function(t,e,i){"use strict";t("../utils/utils");const n={width:500,height:125,strokeColor:"#fff",indicatorColor:"#fc1"},s=(t,e)=>new s.init(t,e);s.init=function(t,e){this.element=window.document.createElement("div"),this.backdrop=window.document.createElement("canvas"),this.front=window.document.createElement("canvas"),this.backdrop.style.position="absolute",this.backdrop.style.margin="0",this.front.style.position="absolute",this.front.style.backgroundColor="transparent",this.front.style.margin="0",this.backdrop.id=`${t}-backdrop`,this.front.id=`${t}-front`,this.element.id=t,this.config=Object.assign({},n),this.element.style.minWidth=this.config.width,this.element.style.minHeight=this.config.height,this.element.appendChild(this.backdrop),this.element.appendChild(this.front),e.appendChild(this.element),this.value=.5,this.buffer=null,this.activate()},s.prototype={drawWave:function(t){var e=this.backdrop.getContext("2d"),i=(this.front.getContext("2d"),e.canvas.width),n=e.canvas.height,s=Math.ceil(t.length/i),o=n/2;e.clearRect(0,0,i,n),e.translate(.5,.5),e.strokeStyle=this.config.strokeColor;for(var h=0;h<i;h++){var r=1,a=-1;for(let e=0;e<s;e++){var c=t[h*s+e];c<r?r=c:c>a&&(a=c)}let i=(1+r)*o,n=Math.max(1,(a-r)*o);1!==n&&(e.beginPath(),e.moveTo(h,i),e.lineTo(h,i+n),e.stroke())}this.render()},render:function(){var t=this.front.getContext("2d"),e=t.canvas.width,i=t.canvas.height;t.clearRect(0,0,e,i),t.strokeStyle=this.config.indicatorColor,t.lineWidth=1,t.beginPath(),t.moveTo(this.value*e,0),t.lineTo(this.value*e,i),t.stroke()},update:function(t){this.value=t.x,this.render()},dragOverHandler:function(t){t.preventDefault()},dropHandler:function(t){t.preventDefault();var e=t.dataTransfer.files[0],i=new FileReader,n=this;i.onload=function(t){var e=t.target.result;context.decodeAudioData(e,function(t){n.buffer=t,n.drawWave(t.getChannelData(0))},function(){alert("loading failed")})},i.readAsArrayBuffer(e)},mouseDragHandler:function(t){t.preventDefault();const e=t.target.id,i=this.backdrop.width;t.offsetX<=i&&(this.value=t.offsetX/i),this.render(),window.document.onmouseup=(t=>{t.preventDefault(),window.document.onmouseup=null,window.document.onmousemove=null}),window.document.onmousemove=(t=>{if(t.preventDefault(),t.target.id===e){const e=this.backdrop.width;t.offsetX<=e&&(this.value=t.offsetX/e),this.render()}})},load:function(t,e){var i=new window.XMLHttpRequest,n=this;return i.open("GET",t,!0),i.responseType="arraybuffer",i.onload=function(){context.decodeAudioData(i.response,function(t){n.buffer=t,n.drawWave(t.getChannelData(0)),e(t)},function(){alert("loading failed")})},i.send(),this},deactivate:function(){this.element.removeEventListener("dragover",this.dragOverHandler.bind(this),!1),this.element.removeEventListener("drop",this.dropHandler.bind(this),!1),this.element.onmousedown=null},activate:function(){this.element.addEventListener("dragover",this.dragOverHandler.bind(this),!1),this.element.addEventListener("drop",this.dropHandler.bind(this),!1),this.element.onmousedown=this.mouseDragHandler.bind(this)}},s.init.prototype=s.prototype,e.exports=s},{"../utils/utils":9}],11:[function(t,e,i){"use strict";const n=t("../common/common"),s={value:.18,radius:120,lineWidth:16,startAngle:180,sweepAngle:360,backdropPadding:4,showHandle:!0,handleRadius:2,handleColor:"#333",rangeColor:"#fc1",backdropColor:"#330",indicatorColor:"#333",rounded:!0},o=(t,e)=>new o.init(t,e);o.init=function(t,e){if(void 0===t)throw"(XYPad) id is required";e=e||window.document.body,this.id=t,this.ctx=null,this.element=null,this.subscribers=[],this.config=Object.assign({},s),this.config.showCrossHair=!0,this.value={x:.75,y:.62},this.element=window.document.createElement("canvas"),this.element.id=this.id,this.ctx=this.element.getContext("2d"),e.appendChild(this.element),this.configure(),this.render(),this.activate()},o.prototype={render:function(){this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height);const t=this.ctx.canvas.height*this.value.y,e=this.ctx.canvas.width*this.value.x;return this.config.showCrossHair&&(this.ctx.strokeStyle="#777",this.ctx.beginPath(),this.ctx.moveTo(0,t),this.ctx.lineTo(this.ctx.canvas.width,t),this.ctx.lineWidth=.5,this.ctx.stroke(),this.ctx.beginPath(),this.ctx.moveTo(e,0),this.ctx.lineTo(e,this.ctx.canvas.height),this.ctx.stroke()),this.config.showHandle&&(this.ctx.beginPath(),this.ctx.arc(e,t,4,0,2*Math.PI),this.ctx.lineWidth=2,this.ctx.fillStyle="#fc1",this.ctx.strokeStyle="#fc1",this.ctx.stroke(),this.ctx.fill()),this.emit(this.value),this},configure:function(t){return this.config=Object.assign(this.config,t),this.element.style.width=this.config.width,this.element.style.height=this.config.height,this.element.style.backgroundColor="#3a3a3a",this.element.style.boxShadow="inset 0 0 16px #111",this.element.style.marginTop="8px",this.element.style.border="0 solid transparent",this.element.style.boxSizing="border-box",this.element.style.borderRadius="8px",this.ctx.canvas.width=this.element.clientWidth,this.ctx.canvas.height=this.element.clientHeight,this.render(),this},touchDragHandler:function(t){t.preventDefault();const e=t.target.id,i=this.ctx.canvas.width,n=this.ctx.canvas.height,s=this.findTouch(t);this.value.x=(s.clientX-s.target.offsetLeft)/i,this.value.y=(s.clientY-s.target.offsetTop)/n,this.element.ontouchend=(t=>{t.preventDefault(),this.element.ontouchend=null,this.element.ontouchmove=null}),this.element.ontouchmove=(t=>{if(t.preventDefault(),t.target.id===e){const e=this.findTouch(t),i=this.ctx.canvas.width,n=this.ctx.canvas.height;this.value.x=(e.clientX-e.target.offsetLeft)/i,this.value.y=(e.clientY-e.target.offsetTop)/n,this.render()}}),this.render()},mouseDragHandler:function(t){t.preventDefault();const e=t.target.id,i=this.ctx.canvas.width,n=this.ctx.canvas.height;t.offsetX<=i&&(this.value.x=t.offsetX/i),t.offsetY<=n&&(this.value.y=t.offsetY/n),window.document.onmouseup=(t=>{t.preventDefault(),window.document.onmouseup=null,window.document.onmousemove=null}),window.document.onmousemove=(t=>{if(t.preventDefault(),t.target.id===e){const e=this.ctx.canvas.width,i=this.ctx.canvas.height;t.offsetX<=e&&(this.value.x=t.offsetX/e),t.offsetY<=i&&(this.value.y=t.offsetY/i),this.render()}}),this.render()},findTouch:n.touch.findTouch,subscribe:n.events.subscribe,unsubscribe:n.events.unsubscribe,emit:n.events.emit,deactivate:function(){return this.element.onmousedown=null,this.element.ontouchstart=null,this},activate:function(){return this.element.onmousedown=this.mouseDragHandler.bind(this),this.element.ontouchstart=this.touchDragHandler.bind(this),this}},o.init.prototype=o.prototype,e.exports=o},{"../common/common":2}]},{},[3])(3)});